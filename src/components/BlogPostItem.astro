---
export interface Props {
  post: {
    slug: string;
    frontmatter: {
      title: string;
      date: Date;
      description?: string;
      external?: boolean;
      url?: string;
      heroImage?: string;
      tags?: string[];
    };
    minutes?: number;
    words?: number;
  };
}

const { post } = Astro.props;

const formattedDate = new Date(post.frontmatter.date).toLocaleDateString(
  "en-us",
  {
    year: "numeric",
    month: "short",
    day: "numeric",
  },
);

const heroImage = !post.frontmatter.external
  ? post.frontmatter.heroImage
  : undefined;
---

{
  post.frontmatter.external ? (
    <a
      href={post.frontmatter.url}
      target="_blank"
      class="unset block p-4 rounded-lg border border-text-muted/20 bg-bg-body transition-all hover:border-text-muted/30 hover:shadow-md"
    >
      <div class="title mb-2">
        <span class="unset hover:text-text-link text-lg font-semibold">
          <span>{post.frontmatter.title}</span>
          <span>
            <i class="ml-1 mr-1 text-[12px] pb-2 fa-solid fa-up-right-from-square pt-1" />
          </span>
        </span>
      </div>
      <div class="flex flex-wrap items-center gap-2 text-text-muted text-sm">
        <time datetime={post.frontmatter.date.toISOString()}>
          {formattedDate}
        </time>
      </div>
    </a>
  ) : (
    <a
      href={`/blog/${post.slug}`}
      class="unset block rounded-lg border border-text-muted/20 overflow-hidden transition-all duration-300 hover:border-text-muted/30 hover:shadow-lg hover:-translate-y-2 group"
    >
      {heroImage && (
        <div class="relative">
          <div class="overflow-hidden" style="height: 200px;">
            <img
              src={heroImage}
              alt=""
              class="w-full h-full object-cover scale-110 blur-[2px] transition-all duration-500 group-hover:scale-100 group-hover:blur-none"
            />
          </div>
          <div class="absolute bottom-0 left-0 right-0 h-0 bg-primary-main transition-all duration-300 group-hover:h-1" />
        </div>
      )}
      <div class="p-4 bg-bg-body">
        <div class="title mb-2">
          <span class="unset text-lg font-semibold transition-colors group-hover:text-primary-main">
            {post.frontmatter.title}
          </span>
        </div>
        <div class="flex flex-wrap items-center gap-2 text-text-muted text-sm mb-2">
          <time datetime={post.frontmatter.date.toISOString()}>
            {formattedDate}
          </time>
          {post.minutes !== undefined && (
            <>
              <span>•</span>
              <span>{post.minutes} min read</span>
              <span>•</span>
              <span>{post.words?.toLocaleString()} words</span>
            </>
          )}
        </div>
        {post.frontmatter.description && (
          <p class="text-text-body text-sm leading-relaxed m-0 mb-3">
            {post.frontmatter.description}
          </p>
        )}
        {!post.frontmatter.external &&
          post.frontmatter.tags &&
          post.frontmatter.tags.length > 0 && (
            <div class="flex flex-wrap gap-1.5 mt-3">
              {post.frontmatter.tags.slice(0, 10).map((tag) => (
                <span class="inline-flex items-center px-2 py-0.5 text-[0.6875rem] font-semibold rounded-full bg-primary-main/10 text-primary-main border border-primary-main/20">
                  {tag}
                </span>
              ))}
            </div>
          )}
      </div>
    </a>
  )
}

---
export interface Props {
  post: {
    slug: string;
    frontmatter: {
      title: string;
      date: Date;
      description?: string;
      external?: boolean;
      url?: string;
      heroImage?: string;
    };
    minutes?: number;
    words?: number;
  };
}

const { post } = Astro.props;

const formattedDate = new Date(post.frontmatter.date).toLocaleDateString(
  "en-us",
  {
    year: "numeric",
    month: "short",
    day: "numeric",
  },
);

const heroImage = !post.frontmatter.external
  ? post.frontmatter.heroImage
  : undefined;
---

{
  post.frontmatter.external ? (
    <a
      href={post.frontmatter.url}
      target="_blank"
      class="unset block p-4 rounded-lg border border-text-muted/10 bg-bg-body transition-all hover:border-text-muted/20 hover:shadow-md"
    >
      <div class="title mb-2">
        <span class="unset hover:text-text-link text-lg font-semibold">
          <span>{post.frontmatter.title}</span>
          <span>
            <i class="ml-1 mr-1 text-[12px] pb-2 fa-solid fa-up-right-from-square pt-1" />
          </span>
        </span>
      </div>
      <div class="flex flex-wrap items-center gap-2 text-text-muted text-sm">
        <time datetime={post.frontmatter.date.toISOString()}>
          {formattedDate}
        </time>
      </div>
    </a>
  ) : (
    <a
      href={`/blog/${post.slug}`}
      class="unset block rounded-lg border border-text-muted/10 overflow-hidden transition-all hover:border-primary-main hover:shadow-md group"
    >
      {heroImage && (
        <div class="overflow-hidden" style="height: 200px;">
          <img
            src={heroImage}
            alt=""
            class="w-full h-full object-cover scale-110 blur-[2px] transition-all duration-500 group-hover:scale-100 group-hover:blur-none"
          />
        </div>
      )}
      <div class="p-4 bg-bg-body">
        <div class="title mb-2">
          <span class="unset text-lg font-semibold transition-colors group-hover:text-primary-main">
            {post.frontmatter.title}
          </span>
        </div>
        <div class="flex flex-wrap items-center gap-2 text-text-muted text-sm mb-2">
          <time datetime={post.frontmatter.date.toISOString()}>
            {formattedDate}
          </time>
          {post.minutes !== undefined && (
            <>
              <span>•</span>
              <span>{post.minutes} min read</span>
              <span>•</span>
              <span>{post.words?.toLocaleString()} words</span>
            </>
          )}
        </div>
        {post.frontmatter.description && (
          <p class="text-text-body text-sm leading-relaxed m-0">
            {post.frontmatter.description}
          </p>
        )}
      </div>
    </a>
  )
}
